program coarrays_01
use iso_fortran_env, only: event_type
implicit none
real, dimension(100), codimension[*] :: A
integer :: B[3,*]
integer :: c[*]
real :: D(100,2)[3,*]
real :: E(1,2,3)[1,2,-(1):3,*]
real, allocatable :: F(:)[:]
real, allocatable :: g(:,:,:)[:,:,:]
real, dimension(20), codimension[20,*] :: h
real, codimension[:], allocatable :: z(:,:)
character :: r(20)[20,0:*]
type(event_type) :: ok_to_overwrite[*]
type(event_type), allocatable :: greeting_ready(:)[:]
integer :: i, n
n = 5
allocate(F(n)[*])
allocate(greeting_ready(num_images())[*])
allocate(g(50, 50, 50)[1:2, 1:2, *])
if ((this_image())==(1)) then
    do i = 2, num_images()
        c = (c) + (c[i])
        event post (ok_to_overwrite[i])
    end do
else
    event wait (ok_to_overwrite)
    event post (greeting_ready(this_image())[1])
end if
sync all
c[3] = c[4]
B[1, 2] = B[3, 4]
D(99, 1)[3, 4] = D(1, 2)[1, 2]
D(99, 1)[3, 3] = 5
D(:, 1)[3, 3] = 5
D(:, 1)[3, 3, team=3] = 5
D(:, 1)[3, 3, team=3, stat=i] = 5
D(:, 1)[3, 3, stat=i] = 5
end program coarrays_01
