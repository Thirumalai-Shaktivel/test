(TranslationUnit [(Module random [(Use types [(UseSymbol dp ())]) (Use utils [(UseSymbol stop_error ())])] [(Declaration () [(SimpleAttribute AttrPrivate)] []) (Declaration () [(SimpleAttribute AttrPublic)] [(randn [] ()) (rand_gamma [] ())]) (Interface (InterfaceHeader2 randn) [(InterfaceModuleProcedure [randn_scalar]) (InterfaceModuleProcedure [randn_vector]) (InterfaceModuleProcedure [randn_matrix]) (InterfaceModuleProcedure [randn_vector_n])]) (Interface (InterfaceHeader2 rand_gamma) [(InterfaceModuleProcedure [rand_gamma_scalar]) (InterfaceModuleProcedure [rand_gamma_vector]) (InterfaceModuleProcedure [rand_gamma_matrix]) (InterfaceModuleProcedure [rand_gamma_vector_n])])] [(Subroutine randn_scalar [(x)] () [] [] [(Declaration (AttrType TypeReal [(() dp Value)] ()) [(AttrIntent Out)] [(x [] ())]) (Declaration (AttrType TypeLogical [] ()) [(SimpleAttribute AttrSave)] [(first [] (Logical .true.))]) (Declaration (AttrType TypeReal [(() dp Value)] ()) [(SimpleAttribute AttrSave)] [(u [(1 2 DimensionExpr)] ())]) (Declaration (AttrType TypeReal [(() dp Value)] ()) [] [(r2 [] ())])] [(If 0 () first [(DoLoop 0 () () () () () [(SubroutineCall 0 random_number [(() u ())] []) (= 0 u (- (* 2 u) 1)) (= 0 r2 (FuncCallOrArray sum [] [(() (** u 2) ())] [])) (If 0 () (BoolOp (< r2 1) And (> r2 0)) [(Exit 0)] [])]) (= 0 u (* u (FuncCallOrArray sqrt [] [(() (/ (* (u- 2) (FuncCallOrArray log [] [(() r2 ())] [])) r2) ())] []))) (= 0 x (FuncCallOrArray u [] [(() 1 ())] []))] [(= 0 x (FuncCallOrArray u [] [(() 2 ())] []))]) (= 0 first (not first))] []) (Subroutine randn_vector_n [(n) (x)] () [] [] [(Declaration (AttrType TypeInteger [] ()) [(AttrIntent In)] [(n [] ())]) (Declaration (AttrType TypeReal [(() dp Value)] ()) [(AttrIntent Out)] [(x [(1 n DimensionExpr)] ())]) (Declaration (AttrType TypeInteger [] ()) [] [(i [] ())])] [(DoLoop 0 () i 1 (FuncCallOrArray size [] [(() x ())] []) () [(SubroutineCall 0 randn [(() (FuncCallOrArray x [] [(() i ())] []) ())] [])])] []) (Subroutine randn_vector [(x)] () [] [] [(Declaration (AttrType TypeReal [(() dp Value)] ()) [(AttrIntent Out)] [(x [(() () DimensionExpr)] ())])] [(SubroutineCall 0 randn_vector_n [(() (FuncCallOrArray size [] [(() x ())] []) ()) (() x ())] [])] []) (Subroutine randn_matrix [(x)] () [] [] [(Declaration (AttrType TypeReal [(() dp Value)] ()) [(AttrIntent Out)] [(x [(() () DimensionExpr) (() () DimensionExpr)] ())])] [(SubroutineCall 0 randn_vector_n [(() (FuncCallOrArray size [] [(() x ())] []) ()) (() x ())] [])] []) (Subroutine rand_gamma0 [(a) (first) (fn_val)] () [] [] [(Declaration (AttrType TypeReal [(() dp Value)] ()) [(AttrIntent In)] [(a [] ())]) (Declaration (AttrType TypeLogical [] ()) [(AttrIntent In)] [(first [] ())]) (Declaration (AttrType TypeReal [(() dp Value)] ()) [(AttrIntent Out)] [(fn_val [] ())]) (Declaration (AttrType TypeReal [(() dp Value)] ()) [(SimpleAttribute AttrSave)] [(c [] ()) (d [] ())]) (Declaration (AttrType TypeReal [(() dp Value)] ()) [] [(U [] ()) (v [] ()) (x [] ())])] [(If 0 () (< a 1) [(SubroutineCall 0 stop_error [(() (Str "Shape parameter must be >= 1") ())] [])] []) (If 0 () first [(= 0 d (- a (/ (Real "1._dp") 3))) (= 0 c (/ 1 (FuncCallOrArray sqrt [] [(() (* 9 d) ())] [])))] []) (DoLoop 0 () () () () () [(DoLoop 0 () () () () () [(SubroutineCall 0 randn [(() x ())] []) (= 0 v (** (+ 1 (* c x)) 3)) (If 0 () (> v 0) [(Exit 0)] [])]) (SubroutineCall 0 random_number [(() U ())] []) (If 0 () (< U (- 1 (* (Real "0.0331_dp") (** x 4)))) [(= 0 fn_val (* d v)) (Exit 0)] [(If 0 () (< (FuncCallOrArray log [] [(() U ())] []) (+ (/ (** x 2) 2) (* d (+ (- 1 v) (FuncCallOrArray log [] [(() v ())] []))))) [(= 0 fn_val (* d v)) (Exit 0)] [])])])] []) (Subroutine rand_gamma_scalar [(a) (x)] () [] [] [(Declaration (AttrType TypeReal [(() dp Value)] ()) [(AttrIntent In)] [(a [] ())]) (Declaration (AttrType TypeReal [(() dp Value)] ()) [(AttrIntent Out)] [(x [] ())])] [(SubroutineCall 0 rand_gamma0 [(() a ()) (() (Logical .true.) ()) (() x ())] [])] []) (Subroutine rand_gamma_vector_n [(a) (n) (x)] () [] [] [(Declaration (AttrType TypeReal [(() dp Value)] ()) [(AttrIntent In)] [(a [] ())]) (Declaration (AttrType TypeInteger [] ()) [(AttrIntent In)] [(n [] ())]) (Declaration (AttrType TypeReal [(() dp Value)] ()) [(AttrIntent Out)] [(x [(1 n DimensionExpr)] ())]) (Declaration (AttrType TypeInteger [] ()) [] [(i [] ())])] [(SubroutineCall 0 rand_gamma0 [(() a ()) (() (Logical .true.) ()) (() (FuncCallOrArray x [] [(() 1 ())] []) ())] []) (DoLoop 0 () i 2 (FuncCallOrArray size [] [(() x ())] []) () [(SubroutineCall 0 rand_gamma0 [(() a ()) (() (Logical .false.) ()) (() (FuncCallOrArray x [] [(() i ())] []) ())] [])])] []) (Subroutine rand_gamma_vector [(a) (x)] () [] [] [(Declaration (AttrType TypeReal [(() dp Value)] ()) [(AttrIntent In)] [(a [] ())]) (Declaration (AttrType TypeReal [(() dp Value)] ()) [(AttrIntent Out)] [(x [(() () DimensionExpr)] ())])] [(SubroutineCall 0 rand_gamma_vector_n [(() a ()) (() (FuncCallOrArray size [] [(() x ())] []) ()) (() x ())] [])] []) (Subroutine rand_gamma_matrix [(a) (x)] () [] [] [(Declaration (AttrType TypeReal [(() dp Value)] ()) [(AttrIntent In)] [(a [] ())]) (Declaration (AttrType TypeReal [(() dp Value)] ()) [(AttrIntent Out)] [(x [(() () DimensionExpr) (() () DimensionExpr)] ())])] [(SubroutineCall 0 rand_gamma_vector_n [(() a ()) (() (FuncCallOrArray size [] [(() x ())] []) ()) (() x ())] [])] [])])])
